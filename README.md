Выполнение итогового проекта по курсу "Инженер данных" (1T Sprint).  
Проект № 5. Служба такси.  
  
  
1) Структура проекта:  
	- директория с выходными данными (Output_data);  
	- директория с презентацией (Presentation);  
	- директория со скриншотами и графиками (Screenshots);  
	- директория со скриптами (Scripts).  
  
Task_final  
├── Output_data  
│    ├── tripdata_output_1.parquet  
│    └── tripdata_output_2.parquet  
│  
├── Presentation  
│    └── presentation_final_task.pptx  
│  
├── Screenshots  
│    ├── 1 dataMart_1_variant1.png  
│    ├── 2 dataMart_2_variant1.png  
│    ├── 3 dataMart_1_variant2.png  
│    ├── 4 dataMart_2_variant2.png  
│    ├── 5 graphic_passengerCount_tipAmount.png  
│    └── 6 graphic_groupsDistance_tipAmount.png  
│  
├── Scripts  
│    ├── data_analysis_graphics.ipynb  
│    ├── final_task_ver1.ipynb  
│    ├── final_task_ver2.ipynb  
│    ├── script_1.txt  
│    └── script_2.txt  
│  
└── README.md  
  
  
2) Описание исходных данных:  
VendorId - ИД компании  
tpep_pickup_datetime - Время и дата, когда пассажир сел в такси  
tpep_dropoff_datetime - Время и дата, когда пассажир вышел из такси  
passanger_count - Количество пассажиров  
trip_distance - Пройденное расстояние  
ratecodeid - Код скорости  
store_and_fwd_flag - Флаг, отвечающий за сохранение записи поездки перед ее отправкой поставщику  
pulocationId - Широта, где была начата поездка  
dolocationid - Долгота, где была начата поездка  
payment_type - Тип оплаты  
fare_amount - Стоимость поездки  
mta_tax - Комиссия автопарка  
tip_amount - Чаевые  
tools_amount - Оплата за платные дороги  
improvement_surchange - Доплата за страховку  
total_amount - Полная стоимость поездки  
congestion_surchange - Дополнительный сбор  
Источник: https://disk.yandex.ru/d/DKeoopbGH1Ttuw  
  
  
3) Задание:  
	- необходимо, используя таблицу поездок для каждого дня рассчитать процент поездок по количеству человек в машине (без пассажиров, 1, 2, 3, 4 и более пассажиров). По итогу должна получиться таблица (parquet) с колонками date, percentage_zero, percentage_1p, percentage_2p, percentage_3p, percentage_4p_plus.  
	- также добавить столбцы к предыдущим результатам с самой дорогой и самой дешевой поездкой для каждой группы.  
Технологический стек – sql, scala (что-то одно).  
Дополнительно: также провести аналитику и построить график на тему “как пройденное расстояние и количество пассажиров влияет на чаевые” в любом удобном инструменте.  
  
  
4) Выполнение работы:  
	4.1) Файлы final_task_ver1.ipynb и script_1.txt содержат решения основной задачи (Spark, Scala).  
		Идея:  
		  - отдельно сгруппировать данные по дате в зависимости от 5 групп пассажиров (по количеству), найти для каждой группы количество поездок, сумму самой дорогой и сумму самой дешевой поездок в рассматриваемый день;  
		  - отдельно сгруппировать данные по дате, найти общее количество поездок в день;  
		  - объединить полученные наборы по дате, найти процент поездок по количеству человек в машине для каждого рассматриваемого дня;  
		  - транспонировать таблицу (преобразовать строки с группами пассажиров в столбцы, добавить столбцы с суммами самой дорогой и самой дешевой поездкой для каждой выделенной группы пассажиров).  
	
	4.2) Файлы final_task_ver2.ipynb и script_2.txt содержат решения основной задачи (Spark, Scala).  
		Идея:  
		  - отдельно сгруппировать данные по дате в зависимости от 5 групп пассажиров (по количеству), найти для каждой группы количество поездок в рассматриваемый день;  
		  - отдельно сгруппировать данные по дате, найти общее количество поездок в день;  
		  - объединить полученные наборы по дате, найти процент поездок по количеству человек в машине для каждого рассматриваемого дня;  
		  - транспонировать таблицу (преобразовать строки с группами пассажиров в столбцы);  
		  - сгруппировать данные по дате в зависимости от 5 групп пассажиров (по количеству), найти сумму самой дорогой и сумму самой дешевой поездки по группам в рассматриваемый день;  
		  - транспонировать таблицу (преобразовать строки с группами пассажиров в столбцы с суммами самой дорогой и самой дешевой поездкой для каждой выделенной группы пассажиров);  
		  - объединить полученные транспонированные наборы по дате.  
	
	4.3) Файл data_analysis_graphics.ipynb содержит python-код для решения дополнительной задачи.  
		Идея:  
		  - построить график зависимости чаевых от количества пассажиров, для этого сгруппировать данные по количеству пассажиров и найти среднее значение чаевых для каждой группы;  
		  - построить график зависимости чаевых от пройденного расстояния, для этого непрерывную переменную "пройденное расстояние" разбить на интервалы и сгруппировать данные по выделенным интервалам, найти среднее значение чаевых для каждого интервала.  
  
  
5) Выходные данные основного задания (таблица (parquet)) расположены в директории Output_data:  
	- tripdata_output_1.parquet соответствует файлу script_1.txt/final_task_ver1.ipynb;  
	- tripdata_output_2.parquet соответствует файлу script_2.txt/final_task_ver2.ipynb.  
  
  
6) Презентация расположена в директории Presentation, скриншоты и полученные графики расположены в директории Screenshots.